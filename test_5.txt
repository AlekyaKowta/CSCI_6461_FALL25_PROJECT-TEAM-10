; Read 5 chars into M[24..28], print them together, newline, HLT.
; Address/Immediate fields are all â‰¤ 31. Uses IX1 for base+offset.

LOC 6

; constants in high mem so we can LDX them:
LDA 0,0,0
AIR 0,24
STR 0,0,30          ; M[30] = 24 (BASE)
LDA 0,0,0
AIR 0,5
STR 0,0,31          ; M[31] = 5  (COUNT)

; === INPUT LOOP ===
LDX 1,30            ; IX1 = BASE (=24)
LDR 2,0,31          ; R2 = COUNT (=5)

INLOOP:
IN  0,0             ; get a char
STR 0,1,0           ; store at M[BASE + 0] via IX1
; bump BASE (kept in M[30]) and reload IX1
LDR 0,0,30
AIR 0,1
STR 0,0,30
LDX 1,30
; decrement COUNT and loop while not zero
SIR 2,1
JZ  2,0,PRINT
JMA 0,INLOOP,0

; === OUTPUT LOOP ===
PRINT:
LDA 0,0,0
AIR 0,24
STR 0,0,30          ; BASE := 24
LDX 1,30
LDR 2,0,31          ; COUNT := 5

OUTLOOP:
LDR 0,1,0
OUT 0,1
; bump BASE and reload IX1
LDR 0,0,30
AIR 0,1
STR 0,0,30
LDX 1,30
; COUNT-- and continue
SIR 2,1
JZ  2,0,NL
JMA 0,OUTLOOP,0

NL:
LDA 0,0,0
AIR 0,13
OUT 0,1
LDA 0,0,0
AIR 0,10
OUT 0,1
HLT
